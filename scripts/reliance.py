import requests
import csv
from datetime import date, timedelta
from dateutil.relativedelta import relativedelta
from html2csv import html2csv

cookies = {
    'gsScrollPos': '',
    'ASP.NET_SessionId': 't5khdt55asyjcg45mlglx4yb',
    '__utmt': '1',
    'TS01bd6a83': '0163c20a9e258e4d4c5b84279e464a803c457a547296d0e29979eda2b21166a74f7066b663297a07378af9431aeb8ffbc4c0aab4c3',
    'TS01bd6a83_31': '01ac10a80670850347a08b4a7e9ba22ae8570121c1bae3c20bd7486734a83d1721841cdbd4d5ce3f9b7cb05b4dd195a5495a204a096678ef2034c47134ef29f0a78bf978422f6785ae8637d765fe896e532aa875d29858d250a78378dd64a13e39305cd3c1cd4d2d2f5484b67280b6c5e0d182b2eded68dfadd1dd688cf0185bf4869c8aabad4a706a6969201c9b7ce4e4329d9b1e53a8dfdbcb89131328cebb1cac2cabe022e839d01109d409c7035a763ca79cd9fe1fc2c42bed60a74b87ac895e7d155a5452241554dfd0b82b6cba870d15866c37facb14fd95a8515009a753f3b5f50b0374e72f750a4955bc63240720bd47126ff7b89e86cef5035e408eae1082a7a9721a13e69e5af4273354bb21e82969d31e9cf1481df39e652458cf2080f937ea1cb935b54060cf4e9c6a1547bf85890aa5a72259ccfa4bda30ab0ffe4119055c6c88571e994f7021cbb697020657d080495b3c260d574005d96322408a3fd1bb22d2c7d81baeab8029db448781c67745ff488d0e950a16f2c55a9d1e9d9a43af5189e9f1862bd7a12170ea83d9dbf22f93b22e4c21d5e61e93e77251ee0a8de1fc0d7656f3d6e197b4311ceb3bad0ad123806f616c766f1c90c2df6bf26082a5811c465b524f215dea39a09f0a05390272346ec869e7bd075db245ed42e48b6400beec76dead05f97e386d5a799b3ecb1d5b031956a12fb14205c440c565dfc984c20e295c7f69eada3c2b27ade91f0102b55a137418c8dc19133491b4f38783',
    '__utma': '1.2030872532.1493571205.1493580109.1493829339.4',
    '__utmb': '1.18.10.1493829339',
    '__utmc': '1',
    '__utmz': '1.1493571248.2.2.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided)',
    'ext_name': 'jaehkpjddfdgiiefcnhahapilbejohhj',
}

headers = {
    'Origin': 'http://www.reliancepensionfund.com',
    'Accept-Encoding': 'gzip, deflate',
    'Accept-Language': 'en-IN,en-GB;q=0.8,en-US;q=0.6,en;q=0.4',
    'Upgrade-Insecure-Requests': '1',
    'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36',
    'Content-Type': 'application/x-www-form-urlencoded',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
    'Cache-Control': 'max-age=0',
    'Referer': 'http://www.reliancepensionfund.com/navs/navhistory.aspx?shortname=navhistory',
    'Connection': 'keep-alive',
    'DNT': '1',
}

params = (
    ('shortname', 'navhistory'),
)

data = [
  ('__EVENTTARGET', ''),
  ('__EVENTARGUMENT', ''),
  ('__LASTFOCUS', ''),
  ('__VIEWSTATE', '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'),
  ('__VIEWSTATEGENERATOR', '4892F9B4'),
  ('__VIEWSTATEENCRYPTED', ''),
  ('__EVENTVALIDATION', 'dtn4e+fOqHY+Jgxl7TOKalYjQZ9ocrpli0P8AIOqWFqWjPhK945rGrCq9IbNp8VRmU61UZycG2yKBbI5SyWvjZ9T8RP/o7PoB/CfoSBWg69ajFkSe8is6rbCnDXOcMgJrgf9R9bE90bAyO9ys0cSy6pJf5/XjGjIathae2rlpLGFRnI/2AC5cldugXLXtebUuNUM0A=='),
  ('txtSearchText', 'Keyword'),
  ('ctl00$Content$NAVHistory1$ddlCategory', ''),
  ('ctl00$Content$NAVHistory1$ddlSchemes', ''),
  ('ctl00$Content$NAVHistory1$btnSearch', 'Search'),
  ('ddlVGS', ''),
]
#print(dict(data))
dictData = dict(data)

fromDate = date(2009, 5, 1)
endDate = date(2017, 5, 1)
monthDelta = relativedelta(months=1)
writer = csv.writer(open("reliance.csv", "a"))
while fromDate < endDate:
    toDate = fromDate + monthDelta - timedelta(1)
    dictData['ctl00$Content$NAVHistory1$txtFromDate'] = fromDate.strftime("%d/%m/%Y")
    dictData['ddlCalMonthDivFromDate'] = str(fromDate.month)
    dictData['ddlCalYearDivFromDate'] = str(fromDate.year)
    dictData['ctl00$Content$NAVHistory1$txtToDate'] = toDate.strftime("%d/%m/%Y")
    dictData['ddlCalMonthDivToDate'] = str(toDate.month)
    dictData['ddlCalYearDivToDate'] = str(toDate.year)
    print("Fetching data from:"+fromDate.strftime("%d/%m/%Y") + " to:"+toDate.strftime("%d/%m/%Y"))
    result = requests.post('http://www.reliancepensionfund.com/navs/navhistory.aspx', headers=headers, params=params, cookies=cookies, data=dictData)

    #NB. Original query string below. It seems impossible to parse and
    #reproduce query strings 100% accurately so the one below is given
    #in case the reproduced version is not "correct".
    # requests.post('http://www.reliancepensionfund.com/navs/navhistory.aspx?shortname=navhistory', headers=headers, cookies=cookies, data=data)
    category = ''

    tableId = "ctl00_Content_NAVHistory1_gvNAVDisplay"
    rows = html2csv(result.text, tableId)
    for row in rows:
        if not row:
            continue
        if len(row) == 1:
            category = '' if row[0] == 'NPS Lite' else row[0]
            continue
        newRow = [row[2], row[0] if not category else row[0] + ' - ' + category, row[1]]
        writer.writerow(newRow)

    fromDate = fromDate + monthDelta
